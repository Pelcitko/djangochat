{"version":3,"sources":["store/utility.js","store/reducers/auth.js","store/actions/actionTypes.js","store/reducers/nav.js","store/reducers/message.js","hoc/hoc.js","settings.js","websocket.js","containers/Chat.js","routes.js","store/actions/auth.js","store/actions/message.js","components/Contact.js","containers/Sidepanel.js","store/actions/nav.js","containers/Profile.js","containers/Form.js","containers/Popup.js","App.js","index.js"],"names":["updateObject","oldObject","updatedProperties","Object","objectSpread","initialState","token","username","error","loading","reducer","state","arguments","length","undefined","action","type","authStart","authSuccess","authFail","authLogout","showAddChatPopup","openAddChatPopup","closeAddChatPopup","messages","chats","concat","toConsumableArray","message","addMessage","reverse","setMessages","setChats","Hoc","props","children","HOST_URL","WebSocketService","classCallCheck","this","callbacks","socketRef","instance","chatUrl","_this","path","WebSocket","onopen","console","log","onmessage","e","data","socketNewMessage","onerror","onclose","connect","close","parsedData","JSON","parse","command","keys","chatId","sendMessage","from","content","messagesCallback","newMessageCallback","send","stringify","err","readyState","WebSocketInstance","getInstance","Chat","possibleConstructorReturn","getPrototypeOf","call","messageChangeHandler","event","setState","target","value","sendMessageHandler","preventDefault","messageObject","match","params","chatID","newChatMessage","renderTimestamp","timestamp","timeDiff","Math","round","Date","getTime","renderMessages","currentUser","map","i","arr","react_default","a","createElement","key","id","style","marginBottom","className","author","src","alt","scrollToBottom","messagesEnd","scrollIntoView","behavior","initialiseChat","_this2","waitForSocketConnection","fetchMessages","callback","component","setTimeout","newProps","_this3","disconnect","_this4","hoc","float","clear","ref","el","onSubmit","onChange","required","placeholder","aria-hidden","React","Component","auth","BaseRouter","Route","exact","logout","localStorage","removeItem","checkAuthTimeout","expirationTime","dispatch","getUserChats","axios","defaults","xsrfHeaderName","xsrfCookieName","headers","Content-Type","Authorization","get","then","res","Contact","NavLink","to","chatURL","color","picURL","name","antIcon","icon","fontSize","spin","Sidepanel","loginForm","changeForm","authenticate","login","password","signup","email","password2","waitForAuthDetails","addChat","activeChats","c","components_Contact","participants","splice","status","indicator","isAuthenticated","onClick","method","htmlFor","userName","post","expirationDate","setItem","catch","actions","password1","messageActions","Profile","Redirect","FormItem","Form","Item","HorizontalAddChatForm","usernames","handleChange","handleSubmit","form","validateFields","values","combined","history","push","fieldsError","_this$props$form","getFieldDecorator","getFieldsError","getFieldError","userNameError","isFieldTouched","es_form","layout","validateStatus","help","rules","es_select","mode","width","es_button","htmlType","disabled","some","field","AddChatForm","create","withRouter","AddChatModal","modal","centered","footer","visible","isVisible","onCancel","App","addCallbacks","bind","assertThisInitialized","onTryAutoSignup","BrowserRouter","containers_Sidepanel","Popup","containers_Profile","routes","nav","authenticated","getItem","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","rootReducer","combineReducers","authReducer","navReducer","messageReducer","createStore","applyMiddleware","thunk","configureStore","app","es","src_App","ReactDOM","render","document","getElementById"],"mappings":"2OAAaA,EAAe,SAACC,EAAWC,GACtC,OAAOC,OAAAC,EAAA,EAAAD,CAAA,GACFF,EACAC,ICADG,EAAe,CACnBC,MAAO,KACPC,SAAU,KACVC,MAAO,KACPC,SAAS,GAgDIC,EAfC,WAAkC,IAAjCC,EAAiCC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAzBP,EAAcU,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAChD,OAAQC,EAAOC,MACb,IC1CsB,aD2CpB,OAjCY,SAACL,EAAOI,GACxB,OAAOf,EAAaW,EAAO,CACzBH,MAAO,KACPC,SAAS,IA8BAQ,CAAUN,GACnB,IC3CwB,eD4CtB,OA5Bc,SAACA,EAAOI,GAC1B,OAAOf,EAAaW,EAAO,CACzBL,MAAOS,EAAOT,MACdC,SAAUQ,EAAOR,SACjBC,MAAO,KACPC,SAAS,IAuBAS,CAAYP,EAAOI,GAC5B,IC5CqB,YD6CnB,OArBW,SAACJ,EAAOI,GACvB,OAAOf,EAAaW,EAAO,CACzBH,MAAOO,EAAOP,MACdC,SAAS,IAkBAU,CAASR,EAAOI,GACzB,IC7CuB,cD8CrB,OAhBa,SAACJ,EAAOI,GACzB,OAAOf,EAAaW,EAAO,CACzBL,MAAO,KACPC,SAAU,OAaDa,CAAWT,GACpB,QACE,OAAOA,IEhDPN,EAAe,CACnBgB,kBAAkB,GAsBLX,EAXC,WAAkC,IAAjCC,EAAiCC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAzBP,EAAcU,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAChD,OAAQC,EAAOC,MACb,IDb+B,sBCc7B,OAXmB,SAACL,EAAOI,GAC/B,OAAOf,EAAaW,EAAO,CAAEU,kBAAkB,IAUpCC,CAAiBX,GAC1B,IDdgC,uBCe9B,OAToB,SAACA,EAAOI,GAChC,OAAOf,EAAaW,EAAO,CAAEU,kBAAkB,IAQpCE,CAAkBZ,GAC3B,QACE,OAAOA,YCnBPN,EAAe,CACnBmB,SAAU,GACVC,MAAO,IAkCMf,EAbC,WAAkC,IAAjCC,EAAiCC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAzBP,EAAcU,EAAWH,UAAAC,OAAA,EAAAD,UAAA,QAAAE,EAChD,OAAQC,EAAOC,MACb,IFtBuB,cEuBrB,OArBa,SAACL,EAAOI,GACzB,OAAOf,EAAaW,EAAO,CACzBa,SAAQ,GAAAE,OAAAvB,OAAAwB,EAAA,EAAAxB,CAAMQ,EAAMa,UAAZ,CAAsBT,EAAOa,YAmB5BC,CAAWlB,EAAOI,GAC3B,IFvBwB,eEwBtB,OAjBc,SAACJ,EAAOI,GAC1B,OAAOf,EAAaW,EAAO,CACzBa,SAAUT,EAAOS,SAASM,YAejBC,CAAYpB,EAAOI,GAC5B,IFxB6B,oBEyB3B,OAbW,SAACJ,EAAOI,GACvB,OAAOf,EAAaW,EAAO,CACzBc,MAAOV,EAAOU,QAWLO,CAASrB,EAAOI,GACzB,QACE,OAAOJ,sECjCEsB,EAFH,SAAAC,GAAK,OAAIA,EAAMC,UCGvBC,EAAW,6CCDTC,aAWJ,SAAAA,IAAelC,OAAAmC,EAAA,EAAAnC,CAAAoC,KAAAF,GAAAE,KATfC,UAAY,GAUVD,KAAKE,UAAY,oEAJjB,OAHKJ,EAAiBK,WACpBL,EAAiBK,SAAW,IAAIL,GAE3BA,EAAiBK,0DAOlBC,GAAS,IAAAC,EAAAL,KACTM,EAAI,GAAAnB,ODdG,2CCcH,aAAAA,OAA4BiB,EAA5B,KACVJ,KAAKE,UAAY,IAAIK,UAAUD,GAC/BN,KAAKE,UAAUM,OAAS,WACbC,QAAQC,IAAI,mBAEvBV,KAAKE,UAAUS,UAAY,SAAAC,GAChBH,QAAQC,IAAIE,EAAEC,MACvBR,EAAKS,iBAAiBF,EAAEC,OAE1Bb,KAAKE,UAAUa,QAAU,SAAAH,GACdH,QAAQC,IAAIE,EAAEvB,UAEzBW,KAAKE,UAAUc,QAAU,WACdP,QAAQC,IAAI,iCACrBL,EAAKY,gDAKPjB,KAAKE,UAAUgB,iDAGAL,GACf,IAAMM,EAAaC,KAAKC,MAAMR,GACxBS,EAAUH,EAAWG,QACgB,IAAvC1D,OAAO2D,KAAKvB,KAAKC,WAAW3B,SAGhB,aAAZgD,GACFtB,KAAKC,UAAUqB,GAASH,EAAWlC,UAErB,gBAAZqC,GACFtB,KAAKC,UAAUqB,GAASH,EAAW9B,gDAIzBrB,EAAUwD,GACtBxB,KAAKyB,YAAY,CACfH,QAAS,iBACTtD,SAAUA,EACVwD,OAAQA,2CAIGnC,GACbW,KAAKyB,YAAY,CACfH,QAAS,cACTI,KAAMrC,EAAQqC,KACdrC,QAASA,EAAQsC,QACjBH,OAAQnC,EAAQmC,8CAIPI,EAAkBC,GAC7B7B,KAAKC,UAAL,SAA6B2B,EAC7B5B,KAAKC,UAAL,YAAgC4B,sCAGtBhB,GACV,IACEb,KAAKE,UAAU4B,KAAKV,KAAKW,UAALnE,OAAAC,EAAA,EAAAD,CAAA,GAAoBiD,KACxC,MAAOmB,GACPvB,QAAQC,IAAIsB,EAAI3C,0CAKlB,OAAOW,KAAKE,UAAU+B,oBAnFpBnC,EACGK,SAAW,KAsFpB,IAEe+B,EAFWpC,EAAiBqC,cCpFrCC,cAaJ,SAAAA,EAAYzC,GAAO,IAAAU,EAAA,OAAAzC,OAAAmC,EAAA,EAAAnC,CAAAoC,KAAAoC,IACjB/B,EAAAzC,OAAAyE,EAAA,EAAAzE,CAAAoC,KAAApC,OAAA0E,EAAA,EAAA1E,CAAAwE,GAAAG,KAAAvC,KAAML,KAbRvB,MAAQ,CAAEiB,QAAS,IAYAgB,EAmBnBmC,qBAAuB,SAAAC,GACrBpC,EAAKqC,SAAS,CAAErD,QAASoD,EAAME,OAAOC,SApBrBvC,EAuBnBwC,mBAAqB,SAAAjC,GACnBA,EAAEkC,iBACF,IAAMC,EAAgB,CACpBrB,KAAMrB,EAAKV,MAAM3B,SACjB2D,QAAStB,EAAKjC,MAAMiB,QACpBmC,OAAQnB,EAAKV,MAAMqD,MAAMC,OAAOC,QAElChB,EAAkBiB,eAAeJ,GACjC1C,EAAKqC,SAAS,CAAErD,QAAS,MA/BRgB,EAkCnB+C,gBAAkB,SAAAC,GAChB,IACMC,EAAWC,KAAKC,QACnB,IAAIC,MAAOC,UAAY,IAAID,KAAKJ,GAAWK,WAAa,KAiB3D,OAfIJ,EAAW,EAEJ,cACAA,EAAW,IAAMA,EAAW,EAE/B,GAAAnE,OAAMmE,EAAN,gBACGA,EAAW,MAAWA,EAAW,GAEpC,GAAAnE,OAAMoE,KAAKC,MAAMF,EAAW,IAA5B,cACGA,EAAW,OAAgBA,EAAW,KAEzC,GAAAnE,OAAMoE,KAAKC,MAAMF,EAAQ,MAAzB,aAEA,GAAAnE,OAAM,IAAIsE,KAAKJ,KApDNhD,EAyDnBsD,eAAiB,SAAA1E,GACf,IAAM2E,EAAcvD,EAAKV,MAAM3B,SAC/B,OAAOiB,EAAS4E,IAAI,SAACxE,EAASyE,EAAGC,GAAb,OAClBC,EAAAC,EAAAC,cAAA,MACEC,IAAK9E,EAAQ+E,GACbC,MAAO,CAAEC,aAAcP,EAAIzF,OAAS,IAAMwF,EAAI,QAAU,QACxDS,UAAWlF,EAAQmF,SAAWZ,EAAc,OAAS,WAErDI,EAAAC,EAAAC,cAAA,OAEEO,IAAG,kDAAAtF,OAAoDE,EAAQmF,QAC/DE,IAAI,gBAENV,EAAAC,EAAAC,cAAA,SACG7E,EAAQsC,QACTqC,EAAAC,EAAAC,cAAA,WACAF,EAAAC,EAAAC,cAAA,aAAQ7D,EAAK+C,gBAAgB/D,EAAQgE,iBAzE1BhD,EA+EnBsE,eAAiB,WACftE,EAAKuE,YAAYC,eAAe,CAAEC,SAAU,YA9E5CzE,EAAK0E,iBAFY1E,gFAVF,IAAA2E,EAAAhF,KACfA,KAAKiF,wBAAwB,WAC3B/C,EAAkBgD,cAChBF,EAAKrF,MAAM3B,SACXgH,EAAKrF,MAAMqD,MAAMC,OAAOC,UAG5BhB,EAAkBjB,QAAQjB,KAAKL,MAAMqD,MAAMC,OAAOC,yEAQ5BiC,GACtB,IAAMC,EAAYpF,KAClBqF,WAAW,WACyB,IAA9BnD,EAAkB9D,SACpBqC,QAAQC,IAAI,sBACZyE,MAGA1E,QAAQC,IAAI,0BACZ0E,EAAUH,wBAAwBE,KAEnC,iDAoEHnF,KAAK2E,8DAIL3E,KAAK2E,mEAGmBW,GAAU,IAAAC,EAAAvF,KAC9BA,KAAKL,MAAMqD,MAAMC,OAAOC,SAAWoC,EAAStC,MAAMC,OAAOC,SAC3DhB,EAAkBsD,aAClBxF,KAAKiF,wBAAwB,WAC3B/C,EAAkBgD,cAChBK,EAAK5F,MAAM3B,SACXsH,EAAStC,MAAMC,OAAOC,UAG1BhB,EAAkBjB,QAAQqE,EAAStC,MAAMC,OAAOC,0CAI3C,IAAAuC,EAAAzF,KACP,OACEgE,EAAAC,EAAAC,cAACwB,EAAD,KACE1B,EAAAC,EAAAC,cAAA,OAAKK,UAAU,YACbP,EAAAC,EAAAC,cAAA,MAAIE,GAAG,YACJpE,KAAKL,MAAMV,UAAYe,KAAK2D,eAAe3D,KAAKL,MAAMV,UACvD+E,EAAAC,EAAAC,cAAA,OACEG,MAAO,CAAEsB,MAAO,OAAQC,MAAO,QAC/BC,IAAK,SAAAC,GACHL,EAAKb,YAAckB,OAK3B9B,EAAAC,EAAAC,cAAA,OAAKK,UAAU,iBACbP,EAAAC,EAAAC,cAAA,QAAM6B,SAAU/F,KAAK6C,oBACnBmB,EAAAC,EAAAC,cAAA,OAAKK,UAAU,QACbP,EAAAC,EAAAC,cAAA,SACE8B,SAAUhG,KAAKwC,qBACfI,MAAO5C,KAAK5B,MAAMiB,QAClB4G,UAAQ,EACR7B,GAAG,qBACH3F,KAAK,OACLyH,YAAY,8BAGdlC,EAAAC,EAAAC,cAAA,UAAQE,GAAG,sBAAsBG,UAAU,UACzCP,EAAAC,EAAAC,cAAA,KAAGK,UAAU,oBAAoB4B,cAAY,qBAhJ1CC,IAAMC,WAiKVpF,cAPS,SAAA7C,GACtB,MAAO,CACLJ,SAAUI,EAAMkI,KAAKtI,SACrBiB,SAAUb,EAAMiB,QAAQJ,WAIbgC,CAAyBmB,GC1JzBmE,EANI,kBACjBvC,EAAAC,EAAAC,cAACwB,EAAD,KACE1B,EAAAC,EAAAC,cAACsC,EAAA,EAAD,CAAOC,OAAK,EAACnG,KAAK,YAAY8E,UAAWhD,wCCGhCzD,EAAc,SAACX,EAAUD,GAEpC,OADS0C,QAAQC,IAAI,qBACd,CACLjC,KRbwB,eQcxBV,MAAOA,EACPC,SAAUA,IAIDY,EAAW,SAAAX,GAEtB,OADSwC,QAAQC,IAAIzC,GACd,CACLQ,KRrBqB,YQsBrBR,MAAOA,IAIEyI,EAAS,WAIpB,OAHAC,aAAaC,WAAW,SACxBD,aAAaC,WAAW,YACxBD,aAAaC,WAAW,kBACjB,CACLnI,KR9BuB,gBQkCdoI,EAAmB,SAAAC,GAC9B,OAAO,SAAAC,GACL1B,WAAW,WACT0B,EAASL,MACS,IAAjBI,KCbME,EAAe,SAAChJ,EAAUD,GACrC,OAAO,SAAAgJ,GACLE,IAAMC,SAASC,eAAiB,cAChCF,IAAMC,SAASE,eAAiB,YAChCH,IAAMC,SAASG,QAAU,CACvBC,eAAgB,mBAChBC,cAAa,SAAApI,OAAWpB,IAE1BkJ,IACGO,IADH,GAAArI,OACUU,EADV,oBAAAV,OACqCnB,IAClCyJ,KAAK,SAAAC,GAAG,OAAIX,GAlBS7H,EAkBoBwI,EAAI7G,KAjBtCJ,QAAQC,IAAIxB,GACjB,CACLT,KTf6B,oBSgB7BS,MAAOA,KAJiB,IAAAA,eCFbyI,EAfC,SAAAhI,GAAK,OACnBqE,EAAAC,EAAAC,cAAC0D,EAAA,EAAD,CAASC,GAAE,GAAA1I,OAAKQ,EAAMmI,SAAWzD,MAAO,CAAE0D,MAAO,SAC/C/D,EAAAC,EAAAC,cAAA,MAAIK,UAAU,WACZP,EAAAC,EAAAC,cAAA,OAAKK,UAAU,QACbP,EAAAC,EAAAC,cAAA,QAAMK,UAAU,0BAChBP,EAAAC,EAAAC,cAAA,OAAKO,IAAK9E,EAAMqI,OAAQtD,IAAG,cAAAvF,OAAgBQ,EAAMsI,QACjDjE,EAAAC,EAAAC,cAAA,OAAKK,UAAU,QACbP,EAAAC,EAAAC,cAAA,KAAGK,UAAU,QAAQ5E,EAAMsI,MAC1BjE,EAAAC,EAAAC,cAAA,KAAGK,UAAU,WAAW5E,EAAMV,eCFnCiJ,EAAUlE,EAAAC,EAAAC,cAACiE,EAAA,EAAD,CAAM1J,KAAK,UAAU4F,MAAO,CAAE+D,SAAU,IAAMC,MAAI,IAE5DC,6MACJlK,MAAQ,CACNmK,WAAW,KA8BbC,WAAa,WACXnI,EAAKqC,SAAS,CAAE6F,WAAYlI,EAAKjC,MAAMmK,eAGzCE,aAAe,SAAA7H,GACbA,EAAEkC,iBACEzC,EAAKjC,MAAMmK,UACblI,EAAKV,MAAM+I,MAAM9H,EAAE+B,OAAO3E,SAAS4E,MAAOhC,EAAE+B,OAAOgG,SAAS/F,OAE5DvC,EAAKV,MAAMiJ,OACThI,EAAE+B,OAAO3E,SAAS4E,MAClBhC,EAAE+B,OAAOkG,MAAMjG,MACfhC,EAAE+B,OAAOgG,SAAS/F,MAClBhC,EAAE+B,OAAOmG,UAAUlG,4FAvCvB,IAAMwC,EAAYpF,KAClBqF,WAAW,WAEmB,OAA1BD,EAAUzF,MAAM5B,YACUQ,IAA1B6G,EAAUzF,MAAM5B,MAEhBqH,EAAUzF,MAAMqH,aACd5B,EAAUzF,MAAM3B,SAChBoH,EAAUzF,MAAM5B,QAIT0C,QAAQC,IAAI,yCACrB0E,EAAU2D,uBAEX,iDAIH/I,KAAK+I,gEAIL/I,KAAKL,MAAMqJ,2CAqBJ,IAAAhE,EAAAhF,KACHiJ,EAAcjJ,KAAKL,MAAMT,MAAM2E,IAAI,SAAAqF,GACrC,OACElF,EAAAC,EAAAC,cAACiF,EAAD,CACEhF,IAAK+E,EAAE9E,GACP6D,KAAI,GAAA9I,OAAK+J,EAAEE,aAAaC,OAAO,EAAE,IACjCrB,OAAM,kDAAA7I,OAAoD+J,EAAE9E,IAE5DkF,OAAO,OACPxB,QAAO,IAAA3I,OAAM+J,EAAE9E,IACfnF,SAAQ,GAAAE,OAAK+J,EAAEjK,SAAS,QAI9B,OACE+E,EAAAC,EAAAC,cAAA,OAAKE,GAAG,aACNJ,EAAAC,EAAAC,cAAA,OAAKE,GAAG,WACNJ,EAAAC,EAAAC,cAAA,OAAKK,UAAU,QACbP,EAAAC,EAAAC,cAAA,OACEE,GAAG,cAEHK,IAAG,kDAAAtF,OAAoDa,KAAKL,MAAM3B,UAClEuG,UAAU,SACVG,IAAI,KAENV,EAAAC,EAAAC,cAAA,yBACAF,EAAAC,EAAAC,cAAA,KACEK,UAAU,mCACV4B,cAAY,SAEdnC,EAAAC,EAAAC,cAAA,OAAKE,GAAG,kBACNJ,EAAAC,EAAAC,cAAA,UACEF,EAAAC,EAAAC,cAAA,MAAIE,GAAG,gBAAgBG,UAAU,UAC/BP,EAAAC,EAAAC,cAAA,QAAMK,UAAU,kBADlB,IACqCP,EAAAC,EAAAC,cAAA,oBAErCF,EAAAC,EAAAC,cAAA,MAAIE,GAAG,eACLJ,EAAAC,EAAAC,cAAA,QAAMK,UAAU,kBADlB,IACqCP,EAAAC,EAAAC,cAAA,kBAErCF,EAAAC,EAAAC,cAAA,MAAIE,GAAG,eACLJ,EAAAC,EAAAC,cAAA,QAAMK,UAAU,kBADlB,IACqCP,EAAAC,EAAAC,cAAA,kBAErCF,EAAAC,EAAAC,cAAA,MAAIE,GAAG,kBACLJ,EAAAC,EAAAC,cAAA,QAAMK,UAAU,kBADlB,IACqCP,EAAAC,EAAAC,cAAA,uBAIzCF,EAAAC,EAAAC,cAAA,OAAKE,GAAG,YACLpE,KAAKL,MAAMzB,QACV8F,EAAAC,EAAAC,cAACmE,EAAA,EAAD,CAAMkB,UAAWrB,IACflI,KAAKL,MAAM6J,gBACbxF,EAAAC,EAAAC,cAAA,UAAQuF,QAAS,kBAAMzE,EAAKrF,MAAM+G,UAAUnC,UAAU,WACpDP,EAAAC,EAAAC,cAAA,6BAGFF,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,QAAMwF,OAAO,OAAO3D,SAAU/F,KAAKyI,cAChCzI,KAAK5B,MAAMmK,UACVvE,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,SACE+D,KAAK,WACLxJ,KAAK,OACLyH,YAAY,aAEdlC,EAAAC,EAAAC,cAAA,SACE+D,KAAK,WACLxJ,KAAK,WACLyH,YAAY,cAIhBlC,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,SACE+D,KAAK,WACLxJ,KAAK,OACLyH,YAAY,aAEdlC,EAAAC,EAAAC,cAAA,SAAO+D,KAAK,QAAQxJ,KAAK,QAAQyH,YAAY,UAC7ClC,EAAAC,EAAAC,cAAA,SACE+D,KAAK,WACLxJ,KAAK,WACLyH,YAAY,aAEdlC,EAAAC,EAAAC,cAAA,SACE+D,KAAK,YACLxJ,KAAK,WACLyH,YAAY,sBAKlBlC,EAAAC,EAAAC,cAAA,UAAQzF,KAAK,UAAb,gBAGFuF,EAAAC,EAAAC,cAAA,UAAQuF,QAASzJ,KAAKwI,YAAtB,oCAMVxE,EAAAC,EAAAC,cAAA,OAAKE,GAAG,UACNJ,EAAAC,EAAAC,cAAA,SAAOyF,QAAQ,IACb3F,EAAAC,EAAAC,cAAA,KAAGK,UAAU,eAAe4B,cAAY,UAE1CnC,EAAAC,EAAAC,cAAA,SAAOzF,KAAK,OAAOyH,YAAY,qBAEjClC,EAAAC,EAAAC,cAAA,OAAKE,GAAG,YACNJ,EAAAC,EAAAC,cAAA,UAAK+E,IAEPjF,EAAAC,EAAAC,cAAA,OAAKE,GAAG,cACNJ,EAAAC,EAAAC,cAAA,UAAQE,GAAG,UAAUqF,QAAS,kBAAMzE,EAAKjG,qBACvCiF,EAAAC,EAAAC,cAAA,KAAGK,UAAU,wBAAwB4B,cAAY,SACjDnC,EAAAC,EAAAC,cAAA,mCAEFF,EAAAC,EAAAC,cAAA,UAAQE,GAAG,YACTJ,EAAAC,EAAAC,cAAA,KAAGK,UAAU,kBAAkB4B,cAAY,SAC3CnC,EAAAC,EAAAC,cAAA,sCArKYkC,IAAMC,WAuMfpF,cA1BS,SAAA7C,GACtB,MAAO,CACLoL,gBAAsC,OAArBpL,EAAMkI,KAAKvI,MAC5BG,QAASE,EAAMkI,KAAKpI,QACpBH,MAAOK,EAAMkI,KAAKvI,MAClBC,SAAUI,EAAMkI,KAAKtI,SAErBkB,MAAOd,EAAMiB,QAAQH,QAIE,SAAA6H,GACzB,MAAO,CACL2B,MAAO,SAACkB,EAAUjB,GAAX,OACH5B,EHzJiB,SAAC/I,EAAU2K,GAClC,OAAO,SAAA5B,GACLA,EAzCK,CACLtI,KRPsB,eQgDtBwI,IACG4C,KADH,GAAA1K,OACWU,EADX,qBACwC,CACpC7B,SAAUA,EACV2K,SAAUA,IAEXlB,KAAK,SAAAC,GACJ,IAAM3J,EAAQ2J,EAAI7G,KAAKsD,IACjB2F,EAAiB,IAAIrG,MAAK,IAAIA,MAAOC,UAAY,MACvDiD,aAAaoD,QAAQ,QAAShM,GAC9B4I,aAAaoD,QAAQ,WAAY/L,GACjC2I,aAAaoD,QAAQ,iBAAkBD,GACvC/C,EAASpI,EAAYX,EAAUD,IAC/BgJ,EAASF,EAAiB,SAE3BmD,MAAM,SAAAhI,GACIvB,QAAQC,IAAIsB,GACrB+E,EAASnI,EAASoD,OGsITiI,CAAkBL,EAAUjB,KACzCjC,OAAQ,kBACJK,EAASkD,MACbrB,OAAQ,SAAC5K,EAAU6K,EAAOqB,EAAWpB,GAA7B,OACJ/B,EHrIkB,SAAC/I,EAAU6K,EAAOqB,EAAWpB,GACrD,OAAO,SAAA/B,GACLA,EAjEK,CACLtI,KRPsB,eQwEtBwI,IACG4C,KADH,GAAA1K,OACWU,EADX,4BAC+C,CAC3C7B,SAAUA,EACV6K,MAAOA,EACPqB,UAAWA,EACXpB,UAAWA,IAEZrB,KAAK,SAAAC,GACJ,IAAM3J,EAAQ2J,EAAI7G,KAAKsD,IACjB2F,EAAiB,IAAIrG,MAAK,IAAIA,MAAOC,UAAY,MACvDiD,aAAaoD,QAAQ,QAAShM,GAC9B4I,aAAaoD,QAAQ,WAAY/L,GACjC2I,aAAaoD,QAAQ,iBAAkBD,GACvC/C,EAASpI,EAAYX,EAAUD,IAC/BgJ,EAASF,EAAiB,SAE3BmD,MAAM,SAAAhI,GACIvB,QAAQC,IAAIsB,GACrB+E,EAASnI,EAASoD,OGgHTiI,CAAmBjM,EAAU6K,EAAOqB,EAAWpB,KAC5DE,QAAS,kBACLjC,ECzMC,CACLtI,KZA+B,yBWyM/BuI,aAAc,SAAChJ,EAAUD,GAAX,OACVgJ,EAASoD,EAA4BnM,EAAUD,OAIxCkD,CAGbqH,YEhNI8B,mLAEF,OAAyB,OAArBpK,KAAKL,MAAM5B,MACNiG,EAAAC,EAAAC,cAACmG,EAAA,EAAD,CAAUxC,GAAG,MAGpB7D,EAAAC,EAAAC,cAAA,OAAKK,UAAU,mBACY,OAAxBvE,KAAKL,MAAM3B,SACVgG,EAAAC,EAAAC,cAACwB,EAAD,KAEE1B,EAAAC,EAAAC,cAAA,OAAKO,IAAG,kDAAAtF,OAAoDa,KAAKL,MAAM3B,UAAY0G,IAAI,KACvFV,EAAAC,EAAAC,cAAA,SAAIlE,KAAKL,MAAM3B,UACfgG,EAAAC,EAAAC,cAAA,OAAKK,UAAU,gBACbP,EAAAC,EAAAC,cAAA,KAAGK,UAAU,iBAAiB4B,cAAY,SAC1CnC,EAAAC,EAAAC,cAAA,KAAGK,UAAU,gBAAgB4B,cAAY,SACzCnC,EAAAC,EAAAC,cAAA,KAAGK,UAAU,kBAAkB4B,cAAY,WAG7C,aAlBUC,IAAMC,WA+BbpF,cAPS,SAAA7C,GACtB,MAAO,CACLJ,SAAUI,EAAMkI,KAAKtI,SACrBD,MAAOK,EAAMkI,KAAKvI,QAIPkD,CAAyBmJ,iDC3BlCE,GAAWC,IAAKC,SAMhBC,8MACJrM,MAAQ,CACNsM,UAAW,GACXzM,MAAO,QAGT0M,aAAe,SAAA/H,GACbvC,EAAKqC,SAAS,CACZgI,UAAW9H,OAQfgI,aAAe,SAAAhK,GAAK,IACV8J,EAAcrK,EAAKjC,MAAnBsM,UACR9J,EAAEkC,iBACFzC,EAAKV,MAAMkL,KAAKC,eAAe,SAAC9I,EAAK+I,GACnC,IAAK/I,EAAK,CACR,IAAMgJ,EAAQ,GAAA7L,OAAAvB,OAAAwB,EAAA,EAAAxB,CAAO8M,GAAP,CAAkBrK,EAAKV,MAAM3B,WAC3CiJ,IAAMC,SAASC,eAAiB,cAChCF,IAAMC,SAASE,eAAiB,YAChCH,IAAMC,SAASG,QAAU,CACvBC,eAAgB,mBAChBC,cAAa,SAAApI,OAAWkB,EAAKV,MAAM5B,QAErCkJ,IACG4C,KADH,GAAA1K,OACWU,EADX,iBACoC,CAChCZ,SAAU,GACVmK,aAAc4B,IAEfvD,KAAK,SAAAC,GACJrH,EAAKV,MAAMsL,QAAQC,KAAnB,IAAA/L,OAA4BuI,EAAI7G,KAAKuD,KACrC/D,EAAKV,MAAMX,oBACXqB,EAAKV,MAAMqH,aAAa3G,EAAKV,MAAM3B,SAAUqC,EAAKV,MAAM5B,SAEzDiM,MAAM,SAAAhI,GACLvB,QAAQxC,MAAM+D,GACd3B,EAAKqC,SAAS,CACZzE,MAAO+D,6FA5BjBhC,KAAKL,MAAMkL,KAAKC,kDAmCT,IApDQK,EAoDRC,EAMHpL,KAAKL,MAAMkL,KAJbQ,EAFKD,EAELC,kBACAC,EAHKF,EAGLE,eACAC,EAJKH,EAILG,cAIIC,GACJC,EATKL,EAKLK,gBAIe,aAAeF,EAAc,YAC9C,OACEvH,EAAAC,EAAAC,cAACwH,EAAA,EAAD,CAAMC,OAAO,SAAS5F,SAAU/F,KAAK4K,cAClC5K,KAAK5B,MAAMH,MAAX,GAAAkB,OAAsBa,KAAK5B,MAAMH,OAAU,KAC5C+F,EAAAC,EAAAC,cAACoG,GAAD,CACEsB,eAAgBJ,EAAgB,QAAU,GAC1CK,KAAML,GAAiB,IAEtBH,EAAkB,WAAY,CAC7BS,MAAO,CACL,CACE7F,UAAU,EACV5G,QACE,mEALPgM,CASCrH,EAAAC,EAAAC,cAAC6H,EAAA,EAAD,CACEC,KAAK,OACL3H,MAAO,CAAE4H,MAAO,QAChB/F,YAAY,YACZF,SAAUhG,KAAK2K,cAEd,MAIP3G,EAAAC,EAAAC,cAACoG,GAAD,KACEtG,EAAAC,EAAAC,cAACgI,GAAA,EAAD,CACEzN,KAAK,UACL0N,SAAS,SACTC,UA5FOjB,EA4FaG,IA3FvB1N,OAAO2D,KAAK4J,GAAakB,KAAK,SAAAC,GAAK,OAAInB,EAAYmB,OAwFlD,yBArF0BlG,IAAMC,WAkGpCkG,GAAchC,IAAKiC,QAALjC,CAAcE,IAiBnBgC,gBACbxL,YAhBsB,SAAA7C,GACtB,MAAO,CACLL,MAAOK,EAAMkI,KAAKvI,MAClBC,SAAUI,EAAMkI,KAAKtI,WAIE,SAAA+I,GACzB,MAAO,CACL/H,kBAAmB,kBAAM+H,EFnHpB,CACLtI,KZLgC,0BcwHhCuI,aAAc,SAAChJ,EAAUD,GAAX,OACZgJ,EAASoD,EAA4BnM,EAAUD,OAKnDkD,CAGEsL,KCnHWG,oLAbX,OACE1I,EAAAC,EAAAC,cAACyI,EAAA,EAAD,CACEC,UAAQ,EACRC,OAAQ,KACRC,QAAS9M,KAAKL,MAAMoN,UACpBC,SAAUhN,KAAKL,MAAMuB,OAErB8C,EAAAC,EAAAC,cAACqG,GAAD,cATmBnE,IAAMC,WCS3B4G,uBAKJ,SAAAA,EAAYtN,GAAO,IAAAU,EAAA,OAAAzC,OAAAmC,EAAA,EAAAnC,CAAAoC,KAAAiN,GACjB5M,EAAAzC,OAAAyE,EAAA,EAAAzE,CAAAoC,KAAApC,OAAA0E,EAAA,EAAA1E,CAAAqP,GAAA1K,KAAAvC,KAAML,IACNuC,EAAkBgL,aAChB7M,EAAKV,MAAMH,YAAY2N,KAAvBvP,OAAAwP,EAAA,EAAAxP,QAAAwP,EAAA,EAAAxP,CAAAyC,KACAA,EAAKV,MAAML,WAAW6N,KAAtBvP,OAAAwP,EAAA,EAAAxP,QAAAwP,EAAA,EAAAxP,CAAAyC,MAJeA,mFAHjBL,KAAKL,MAAM0N,oEAWJ,IAAArI,EAAAhF,KACP,OACEgE,EAAAC,EAAAC,cAACoJ,EAAA,EAAD,KACEtJ,EAAAC,EAAAC,cAAA,OAAKE,GAAG,SACNJ,EAAAC,EAAAC,cAACqJ,EAAD,MACAvJ,EAAAC,EAAAC,cAAA,OAAKK,UAAU,WACbP,EAAAC,EAAAC,cAACsJ,GAAD,CACET,UAAW/M,KAAKL,MAAMb,iBACtBoC,MAAO,kBAAM8D,EAAKrF,MAAMX,uBAE1BgF,EAAAC,EAAAC,cAACuJ,EAAD,MACAzJ,EAAAC,EAAAC,cAACwJ,EAAD,gBAxBMtH,IAAMC,YAgDTpF,eAhBS,SAAA7C,GACtB,MAAO,CACLU,iBAAkBV,EAAMuP,IAAI7O,iBAC5B8O,cAAexP,EAAMkI,KAAKvI,QAIH,SAAAgJ,GACzB,MAAO,CACLsG,gBAAiB,kBAAMtG,ER0ClB,SAAAA,GACL,IAAMhJ,EAAQ4I,aAAakH,QAAQ,SAC7B7P,EAAW2I,aAAakH,QAAQ,YACtC,QAActP,IAAVR,EACFgJ,EAASL,SACJ,CACL,IAAMoD,EAAiB,IAAIrG,KAAKkD,aAAakH,QAAQ,mBACjD/D,GAAkB,IAAIrG,KACxBsD,EAASL,MAETK,EAASpI,EAAYX,EAAUD,IAC/BgJ,EACEF,GACGiD,EAAepG,WAAY,IAAID,MAAOC,WAAa,WQtD5D1E,kBAAmB,kBAAM+H,EJ9CpB,CACLtI,KZLgC,0BgBmDhCa,WAAY,SAAAD,GAAO,OAAI0H,EPpDD,SAAA1H,GAExB,OADYoB,QAAQC,IAAIrB,GACjB,CACLZ,KTDuB,cSEvBY,QAASA,GOgDuB8K,CAA0B9K,KAC1DG,YAAa,SAAAP,GAAQ,OAAI8H,EP7CF,SAAA9H,GAEzB,OADYwB,QAAQC,IAAIzB,GACjB,CACLR,KTRwB,eSSxBQ,SAAUA,GOyCwBkL,CAA2BlL,OAIlDgC,CAGbgM,ICrDIa,GAAmBC,OAAOC,sCAAwCC,IAwBxE,IAAMC,GAtBN,WACE,IAAMC,EAAcC,YAAgB,CAClC9H,KAAM+H,EACNV,IAAKW,EACLjP,QAASkP,IAeX,OAZcC,YACZL,EACAL,GAAiBW,YAAgBC,OAavBC,GAERC,GACJ5K,EAAAC,EAAAC,cAAC2K,EAAA,EAAD,CAAUX,MAAOA,IACflK,EAAAC,EAAAC,cAAC4K,GAAD,OAIJC,IAASC,OAAOJ,GAAKK,SAASC,eAAe","file":"static/js/main.588f83b0.chunk.js","sourcesContent":["export const updateObject = (oldObject, updatedProperties) => {\n  return {\n    ...oldObject,\n    ...updatedProperties\n  };\n};\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  token: null,\n  username: null,\n  error: null,\n  loading: false\n};\n\nconst authStart = (state, action) => {\n  return updateObject(state, {\n    error: null,\n    loading: true\n  });\n};\n\nconst authSuccess = (state, action) => {\n  return updateObject(state, {\n    token: action.token,\n    username: action.username,\n    error: null,\n    loading: false\n  });\n};\n\nconst authFail = (state, action) => {\n  return updateObject(state, {\n    error: action.error,\n    loading: false\n  });\n};\n\nconst authLogout = (state, action) => {\n  return updateObject(state, {\n    token: null,\n    username: null\n  });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.AUTH_START:\n      return authStart(state, action);\n    case actionTypes.AUTH_SUCCESS:\n      return authSuccess(state, action);\n    case actionTypes.AUTH_FAIL:\n      return authFail(state, action);\n    case actionTypes.AUTH_LOGOUT:\n      return authLogout(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","export const AUTH_START = \"AUTH_START\";\nexport const AUTH_SUCCESS = \"AUTH_SUCCESS\";\nexport const AUTH_FAIL = \"AUTH_FAIL\";\nexport const AUTH_LOGOUT = \"AUTH_LOGOUT\";\nexport const OPEN_ADD_CHAT_POPUP = \"OPEN_ADD_CHAT_POPUP\";\nexport const CLOSE_ADD_CHAT_POPUP = \"CLOSE_ADD_CHAT_POPUP\";\nexport const ADD_MESSAGE = \"ADD_MESSAGE\";\nexport const SET_MESSAGES = \"SET_MESSAGES\";\nexport const GET_CHATS_SUCCESS = \"GET_CHATS_SUCCESS\";\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  showAddChatPopup: false\n};\n\nconst openAddChatPopup = (state, action) => {\n  return updateObject(state, { showAddChatPopup: true });\n};\n\nconst closeAddChatPopup = (state, action) => {\n  return updateObject(state, { showAddChatPopup: false });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.OPEN_ADD_CHAT_POPUP:\n      return openAddChatPopup(state, action);\n    case actionTypes.CLOSE_ADD_CHAT_POPUP:\n      return closeAddChatPopup(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","import * as actionTypes from \"../actions/actionTypes\";\nimport { updateObject } from \"../utility\";\n\nconst initialState = {\n  messages: [],\n  chats: []\n};\n\nconst addMessage = (state, action) => {\n  return updateObject(state, {\n    messages: [...state.messages, action.message]\n  });\n};\n\nconst setMessages = (state, action) => {\n  return updateObject(state, {\n    messages: action.messages.reverse()\n  });\n};\n\nconst setChats = (state, action) => {\n  return updateObject(state, {\n    chats: action.chats\n  });\n};\n\nconst reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case actionTypes.ADD_MESSAGE:\n      return addMessage(state, action);\n    case actionTypes.SET_MESSAGES:\n      return setMessages(state, action);\n    case actionTypes.GET_CHATS_SUCCESS:\n      return setChats(state, action);\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","const Hoc = props => props.children;\n\nexport default Hoc;\n","let DEBUG = true;\n// let HOST_URL = \"http://djangochat-4280.rostiapp.cz\";\n// let SOCKET_URL = \"ws://djangochat-4280.rostiapp.cz\";\nlet HOST_URL = \"https://cryptic-plains-09325.herokuapp.com\";\nlet SOCKET_URL = \"wss://cryptic-plains-09325.herokuapp.com\";\n// if (DEBUG) {\n//   // HOST_URL = \"http://localhost:8000\";\n//   // SOCKET_URL = \"ws://localhost:8000\";\n//   HOST_URL = \"http://147.230.155.90:8000\"; // TUL síť\n//   SOCKET_URL = \"ws://147.230.155.90:8000\"; // TUL síť\n// }\n\nexport { HOST_URL, SOCKET_URL, DEBUG };\n","import { SOCKET_URL, DEBUG } from \"./settings\";\n\nclass WebSocketService {\n  static instance = null;\n  callbacks = {};\n\n  static getInstance() {\n    if (!WebSocketService.instance) {\n      WebSocketService.instance = new WebSocketService();\n    }\n    return WebSocketService.instance;\n  }\n\n  constructor() {\n    this.socketRef = null;\n  }\n\n  connect(chatUrl) {\n    const path = `${SOCKET_URL}/ws/chat/${chatUrl}/`;\n    this.socketRef = new WebSocket(path);\n    this.socketRef.onopen = () => {\n      DEBUG && console.log(\"WebSocket open\");\n    };\n    this.socketRef.onmessage = e => {\n      DEBUG && console.log(e.data);\n      this.socketNewMessage(e.data);\n    };\n    this.socketRef.onerror = e => {\n      DEBUG && console.log(e.message);\n    };\n    this.socketRef.onclose = () => {\n      DEBUG && console.log(\"WebSocket closed let's reopen\");\n      this.connect();\n    };\n  }\n\n  disconnect() {\n    this.socketRef.close();\n  }\n\n  socketNewMessage(data) {\n    const parsedData = JSON.parse(data);\n    const command = parsedData.command;\n    if (Object.keys(this.callbacks).length === 0) {\n      return;\n    }\n    if (command === \"messages\") {\n      this.callbacks[command](parsedData.messages);\n    }\n    if (command === \"new_message\") {\n      this.callbacks[command](parsedData.message);\n    }\n  }\n\n  fetchMessages(username, chatId) {\n    this.sendMessage({\n      command: \"fetch_messages\",\n      username: username,\n      chatId: chatId\n    });\n  }\n\n  newChatMessage(message) {\n    this.sendMessage({\n      command: \"new_message\",\n      from: message.from,\n      message: message.content,\n      chatId: message.chatId\n    });\n  }\n\n  addCallbacks(messagesCallback, newMessageCallback) {\n    this.callbacks[\"messages\"] = messagesCallback;\n    this.callbacks[\"new_message\"] = newMessageCallback;\n  }\n\n  sendMessage(data) {\n    try {\n      this.socketRef.send(JSON.stringify({ ...data }));\n    } catch (err) {\n      console.log(err.message);\n    }\n  }\n\n  state() {\n    return this.socketRef.readyState;\n  }\n}\n\nconst WebSocketInstance = WebSocketService.getInstance();\n\nexport default WebSocketInstance;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport WebSocketInstance from \"../websocket\";\nimport Hoc from \"../hoc/hoc\";\n\nclass Chat extends React.Component {\n  state = { message: \"\" };\n\n  initialiseChat() {\n    this.waitForSocketConnection(() => {\n      WebSocketInstance.fetchMessages(\n        this.props.username,\n        this.props.match.params.chatID\n      );\n    });\n    WebSocketInstance.connect(this.props.match.params.chatID);\n  }\n\n  constructor(props) {\n    super(props);\n    this.initialiseChat();\n  }\n\n  waitForSocketConnection(callback) {\n    const component = this;\n    setTimeout(function() {\n      if (WebSocketInstance.state() === 1) {\n        console.log(\"Connection is made\");\n        callback();\n        // return;\n      } else {\n        console.log(\"wait for connection...\");\n        component.waitForSocketConnection(callback);\n      }\n    }, 100);\n  }\n\n  messageChangeHandler = event => {\n    this.setState({ message: event.target.value });\n  };\n\n  sendMessageHandler = e => {\n    e.preventDefault();\n    const messageObject = {\n      from: this.props.username,\n      content: this.state.message,\n      chatId: this.props.match.params.chatID\n    };\n    WebSocketInstance.newChatMessage(messageObject);\n    this.setState({ message: \"\" });\n  };\n\n  renderTimestamp = timestamp => {\n    let prefix = \"\";\n    const timeDiff = Math.round(\n      (new Date().getTime() - new Date(timestamp).getTime()) / 60000\n    );\n    if (timeDiff < 1) {\n      // less than one minute ago\n      prefix = \"just now...\";\n    } else if (timeDiff < 60 && timeDiff > 1) {\n      // less than sixty minutes ago\n      prefix = `${timeDiff} minutes ago`;\n    } else if (timeDiff < 24 * 60 && timeDiff > 60) {\n      // less than 24 hours ago\n      prefix = `${Math.round(timeDiff / 60)} hours ago`;\n    } else if (timeDiff < 31 * 24 * 60 && timeDiff > 24 * 60) {\n      // less than 7 days ago\n      prefix = `${Math.round(timeDiff / (60 * 24))} days ago`;\n    } else {\n      prefix = `${new Date(timestamp)}`;\n    }\n    return prefix;\n  };\n\n  renderMessages = messages => {\n    const currentUser = this.props.username;\n    return messages.map((message, i, arr) => (\n      <li\n        key={message.id}\n        style={{ marginBottom: arr.length - 1 === i ? \"300px\" : \"15px\" }}\n        className={message.author === currentUser ? \"sent\" : \"replies\"}\n      >\n        <img\n          // src=\"http://emilcarlsson.se/assets/mikeross.png|\n          src={`https://loremflickr.com/320/320/dog,cat?random=${message.author}`}\n          alt=\"profile-pic\"\n        />\n        <p>\n          {message.content}\n          <br />\n          <small>{this.renderTimestamp(message.timestamp)}</small>\n        </p>\n      </li>\n    ));\n  };\n\n  scrollToBottom = () => {\n    this.messagesEnd.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  componentDidMount() {\n    this.scrollToBottom();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  componentWillReceiveProps(newProps) {\n    if (this.props.match.params.chatID !== newProps.match.params.chatID) {\n      WebSocketInstance.disconnect();\n      this.waitForSocketConnection(() => {\n        WebSocketInstance.fetchMessages(\n          this.props.username,\n          newProps.match.params.chatID\n        );\n      });\n      WebSocketInstance.connect(newProps.match.params.chatID);\n    }\n  }\n\n  render() {\n    return (\n      <Hoc>\n        <div className=\"messages\">\n          <ul id=\"chat-log\">\n            {this.props.messages && this.renderMessages(this.props.messages)}\n            <div\n              style={{ float: \"left\", clear: \"both\" }}\n              ref={el => {\n                this.messagesEnd = el;\n              }}\n            />\n          </ul>\n        </div>\n        <div className=\"message-input\">\n          <form onSubmit={this.sendMessageHandler}>\n            <div className=\"wrap\">\n              <input\n                onChange={this.messageChangeHandler}\n                value={this.state.message}\n                required\n                id=\"chat-message-input\"\n                type=\"text\"\n                placeholder=\"Napište zprávu...\"\n              />\n              {/*<i className=\"fa fa-paperclip attachment\" aria-hidden=\"true\" />*/}\n              <button id=\"chat-message-submit\" className=\"submit\">\n                <i className=\"fa fa-paper-plane\" aria-hidden=\"true\" />\n              </button>\n            </div>\n          </form>\n        </div>\n      </Hoc>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.auth.username,\n    messages: state.message.messages\n  };\n};\n\nexport default connect(mapStateToProps)(Chat);\n","import React from \"react\";\nimport { Route } from \"react-router-dom\";\nimport Hoc from \"./hoc/hoc\";\n\nimport Chat from \"./containers/Chat\";\n\nconst BaseRouter = () => (\n  <Hoc>\n    <Route exact path=\"/:chatID/\" component={Chat} />\n  </Hoc>\n);\n\nexport default BaseRouter;\n","import axios from \"axios\";\nimport * as actionTypes from \"./actionTypes\";\n// import { HOST_URL } from \"../settings\";\nimport { HOST_URL, DEBUG } from \"../../settings\";\n\nexport const authStart = () => {\n  return {\n    type: actionTypes.AUTH_START\n  };\n};\n\nexport const authSuccess = (username, token) => {\n  DEBUG && console.log(\"user logged in...\");\n  return {\n    type: actionTypes.AUTH_SUCCESS,\n    token: token,\n    username: username\n  };\n};\n\nexport const authFail = error => {\n  DEBUG && console.log(error);\n  return {\n    type: actionTypes.AUTH_FAIL,\n    error: error\n  };\n};\n\nexport const logout = () => {\n  localStorage.removeItem(\"token\");\n  localStorage.removeItem(\"username\");\n  localStorage.removeItem(\"expirationDate\");\n  return {\n    type: actionTypes.AUTH_LOGOUT\n  };\n};\n\nexport const checkAuthTimeout = expirationTime => {\n  return dispatch => {\n    setTimeout(() => {\n      dispatch(logout());\n    }, expirationTime * 1000);\n  };\n};\n\nexport const authLogin = (username, password) => {\n  return dispatch => {\n    dispatch(authStart());\n    axios\n      .post(`${HOST_URL}/rest-auth/login/`, {\n        username: username,\n        password: password\n      })\n      .then(res => {\n        const token = res.data.key;\n        const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\n        localStorage.setItem(\"token\", token);\n        localStorage.setItem(\"username\", username);\n        localStorage.setItem(\"expirationDate\", expirationDate);\n        dispatch(authSuccess(username, token));\n        dispatch(checkAuthTimeout(3600));\n      })\n      .catch(err => {\n        DEBUG && console.log(err);\n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authSignup = (username, email, password1, password2) => {\n  return dispatch => {\n    dispatch(authStart());\n    axios\n      .post(`${HOST_URL}/rest-auth/registration/`, {\n        username: username,\n        email: email,\n        password1: password1,\n        password2: password2\n      })\n      .then(res => {\n        const token = res.data.key;\n        const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\n        localStorage.setItem(\"token\", token);\n        localStorage.setItem(\"username\", username);\n        localStorage.setItem(\"expirationDate\", expirationDate);\n        dispatch(authSuccess(username, token));\n        dispatch(checkAuthTimeout(3600));\n      })\n      .catch(err => {\n        DEBUG && console.log(err);\n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authCheckState = () => {\n  return dispatch => {\n    const token = localStorage.getItem(\"token\");\n    const username = localStorage.getItem(\"username\");\n    if (token === undefined) {\n      dispatch(logout());\n    } else {\n      const expirationDate = new Date(localStorage.getItem(\"expirationDate\"));\n      if (expirationDate <= new Date()) {\n        dispatch(logout());\n      } else {\n        dispatch(authSuccess(username, token));\n        dispatch(\n          checkAuthTimeout(\n            (expirationDate.getTime() - new Date().getTime()) / 1000\n          )\n        );\n      }\n    }\n  };\n};\n","import axios from \"axios\";\nimport * as actionTypes from \"./actionTypes\";\nimport { HOST_URL, DEBUG } from \"../../settings\";\n\nexport const addMessage = message => {\n  if (DEBUG) {console.log(message)}\n  return {\n    type: actionTypes.ADD_MESSAGE,\n    message: message\n  };\n};\n\nexport const setMessages = messages => {\n  if (DEBUG) {console.log(messages)}\n  return {\n    type: actionTypes.SET_MESSAGES,\n    messages: messages\n  };\n};\n\nconst getUserChatsSuccess = chats => {\n  if (DEBUG) {console.log(chats)}\n  return {\n    type: actionTypes.GET_CHATS_SUCCESS,\n    chats: chats\n  };\n};\n\nexport const getUserChats = (username, token) => {\n  return dispatch => {\n    axios.defaults.xsrfHeaderName = \"X-CSRFTOKEN\";\n    axios.defaults.xsrfCookieName = \"csrftoken\";\n    axios.defaults.headers = {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Token ${token}`\n    };\n    axios\n      .get(`${HOST_URL}/chat/?username=${username}`)\n      .then(res => dispatch(getUserChatsSuccess(res.data)));\n  };\n};\n","import React from \"react\";\nimport { NavLink } from \"react-router-dom\";\n\nconst Contact = props => (\n  <NavLink to={`${props.chatURL}`} style={{ color: \"#fff\" }}>\n    <li className=\"contact\">\n      <div className=\"wrap\">\n        <span className=\"contact-status active\" />\n        <img src={props.picURL} alt={`profile of ${props.name}`} />\n        <div className=\"meta\">\n          <p className=\"name\">{props.name}</p>\n           <p className=\"preview\">{props.messages}</p>\n        </div>\n      </div>\n    </li>\n  </NavLink>\n);\n\nexport default Contact;\n","import React from \"react\";\nimport { Spin, Icon } from \"antd\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../store/actions/auth\";\nimport * as navActions from \"../store/actions/nav\";\nimport * as messageActions from \"../store/actions/message\";\nimport Contact from \"../components/Contact\";\nimport { HOST_URL, DEBUG } from \"../settings\";\n\nconst antIcon = <Icon type=\"loading\" style={{ fontSize: 24 }} spin />;\n\nclass Sidepanel extends React.Component {\n  state = {\n    loginForm: true\n  };\n\n  waitForAuthDetails() {\n    const component = this;\n    setTimeout(function() {\n      if (\n        component.props.token !== null &&\n        component.props.token !== undefined\n      ) {\n        component.props.getUserChats(\n          component.props.username,\n          component.props.token\n        );\n        // return;\n      } else {\n        DEBUG && console.log(\"waiting for authentication details...\");\n        component.waitForAuthDetails();\n      }\n    }, 100);\n  }\n\n  componentDidMount() {\n    this.waitForAuthDetails();\n  }\n\n  openAddChatPopup() {\n    this.props.addChat();\n  }\n\n  changeForm = () => {\n    this.setState({ loginForm: !this.state.loginForm });\n  };\n\n  authenticate = e => {\n    e.preventDefault();\n    if (this.state.loginForm) {\n      this.props.login(e.target.username.value, e.target.password.value);\n    } else {\n      this.props.signup(\n        e.target.username.value,\n        e.target.email.value,\n        e.target.password.value,\n        e.target.password2.value\n      );\n    }\n  };\n\n  render() {\n    let activeChats = this.props.chats.map(c => {\n      return (\n        <Contact\n          key={c.id}\n          name={`${c.participants.splice(0,1)}`}\n          picURL={`https://loremflickr.com/320/320/dog,cat?random=${c.id}`}\n          // status={c.status}\n          status=\"busy\"\n          chatURL={`/${c.id}`}\n          messages={`${c.messages[0]}`}\n        />\n      );\n    });\n    return (\n      <div id=\"sidepanel\">\n        <div id=\"profile\">\n          <div className=\"wrap\">\n            <img\n              id=\"profile-img\"\n              // src=\"http://emilcarlsson.se/assets/mikeross.png\"\n              src={`https://loremflickr.com/320/320/dog,cat?random=${this.props.username}`}\n              className=\"online\"\n              alt=\"\"\n            />\n            <p>Účet</p>\n            <i\n              className=\"fa fa-chevron-down expand-button\"\n              aria-hidden=\"true\"\n            />\n            <div id=\"status-options\">\n              <ul>\n                <li id=\"status-online\" className=\"active\">\n                  <span className=\"status-circle\" /> <p>Online</p>\n                </li>\n                <li id=\"status-away\">\n                  <span className=\"status-circle\" /> <p>Away</p>\n                </li>\n                <li id=\"status-busy\">\n                  <span className=\"status-circle\" /> <p>Busy</p>\n                </li>\n                <li id=\"status-offline\">\n                  <span className=\"status-circle\" /> <p>Offline</p>\n                </li>\n              </ul>\n            </div>\n            <div id=\"expanded\">\n              {this.props.loading ? (\n                <Spin indicator={antIcon} />\n              ) : this.props.isAuthenticated ? (\n                <button onClick={() => this.props.logout()} className=\"authBtn\">\n                  <span>Odahlásit</span>\n                </button>\n              ) : (\n                <div>\n                  <form method=\"POST\" onSubmit={this.authenticate}>\n                    {this.state.loginForm ? (\n                      <div>\n                        <input\n                          name=\"username\"\n                          type=\"text\"\n                          placeholder=\"username\"\n                        />\n                        <input\n                          name=\"password\"\n                          type=\"password\"\n                          placeholder=\"password\"\n                        />\n                      </div>\n                    ) : (\n                      <div>\n                        <input\n                          name=\"username\"\n                          type=\"text\"\n                          placeholder=\"username\"\n                        />\n                        <input name=\"email\" type=\"email\" placeholder=\"email\" />\n                        <input\n                          name=\"password\"\n                          type=\"password\"\n                          placeholder=\"password\"\n                        />\n                        <input\n                          name=\"password2\"\n                          type=\"password\"\n                          placeholder=\"password confirm\"\n                        />\n                      </div>\n                    )}\n\n                    <button type=\"submit\">Registrovat</button>\n                  </form>\n\n                  <button onClick={this.changeForm}>Radši přihlásit</button>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n        <div id=\"search\">\n          <label htmlFor=\"\">\n            <i className=\"fa fa-search\" aria-hidden=\"true\" />\n          </label>\n          <input type=\"text\" placeholder=\"Search Chats...\" />\n        </div>\n        <div id=\"contacts\">\n          <ul>{activeChats}</ul>\n        </div>\n        <div id=\"bottom-bar\">\n          <button id=\"addChat\" onClick={() => this.openAddChatPopup()}>\n            <i className=\"fa fa-user-plus fa-fw\" aria-hidden=\"true\" />\n            <span>Nové spojení</span>\n          </button>\n          <button id=\"settings\">\n            <i className=\"fa fa-cog fa-fw\" aria-hidden=\"true\" />\n            <span>Nastavení</span>\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    isAuthenticated: state.auth.token !== null,\n    loading: state.auth.loading,\n    token: state.auth.token,\n    username: state.auth.username,\n    // userId: state.auth.id,\n    chats: state.message.chats\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    login: (userName, password) =>\n        dispatch(actions.authLogin(userName, password)),\n    logout: () =>\n        dispatch(actions.logout()),\n    signup: (username, email, password1, password2) =>\n        dispatch(actions.authSignup(username, email, password1, password2)),\n    addChat: () =>\n        dispatch(navActions.openAddChatPopup()),\n    getUserChats: (username, token) =>\n        dispatch(messageActions.getUserChats(username, token))\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(Sidepanel);\n","import * as actionTypes from \"./actionTypes\";\n\nexport const openAddChatPopup = () => {\n  return {\n    type: actionTypes.OPEN_ADD_CHAT_POPUP\n  };\n};\n\nexport const closeAddChatPopup = () => {\n  return {\n    type: actionTypes.CLOSE_ADD_CHAT_POPUP\n  };\n};\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\nimport Hoc from \"../hoc/hoc\";\n\nclass Profile extends React.Component {\n  render() {\n    if (this.props.token === null) {\n      return <Redirect to=\"/\" />;\n    }\n    return (\n      <div className=\"contact-profile\">\n        {this.props.username !== null ? (\n          <Hoc>\n            {/*<img src=\"http://emilcarlsson.se/assets/harveyspecter.png\" alt=\"\" />*/}\n            <img src={`https://loremflickr.com/320/320/dog,cat?random=${this.props.username}`} alt=\"\" />\n            <p>{this.props.username}</p>\n            <div className=\"social-media\">\n              <i className=\"fa fa-facebook\" aria-hidden=\"true\" />\n              <i className=\"fa fa-twitter\" aria-hidden=\"true\" />\n              <i className=\"fa fa-instagram\" aria-hidden=\"true\" />\n            </div>\n          </Hoc>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.auth.username,\n    token: state.auth.token\n  };\n};\n\nexport default connect(mapStateToProps)(Profile);\n","import React from \"react\";\nimport { Form, Button, Select } from \"antd\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport * as navActions from \"../store/actions/nav\";\nimport * as messageActions from \"../store/actions/message\";\nimport { HOST_URL } from \"../settings\";\n\nconst FormItem = Form.Item;\n\nfunction hasErrors(fieldsError) {\n  return Object.keys(fieldsError).some(field => fieldsError[field]);\n}\n\nclass HorizontalAddChatForm extends React.Component {\n  state = {\n    usernames: [],\n    error: null\n  };\n\n  handleChange = value => {\n    this.setState({\n      usernames: value\n    });\n  };\n\n  componentDidMount() {\n    this.props.form.validateFields();\n  }\n\n  handleSubmit = e => {\n    const { usernames } = this.state;\n    e.preventDefault();\n    this.props.form.validateFields((err, values) => {\n      if (!err) {\n        const combined = [...usernames, this.props.username];\n        axios.defaults.xsrfHeaderName = \"X-CSRFTOKEN\";\n        axios.defaults.xsrfCookieName = \"csrftoken\";\n        axios.defaults.headers = {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Token ${this.props.token}`\n        };\n        axios\n          .post(`${HOST_URL}/chat/create/`, {\n            messages: [],\n            participants: combined\n          })\n          .then(res => {\n            this.props.history.push(`/${res.data.id}`);\n            this.props.closeAddChatPopup();\n            this.props.getUserChats(this.props.username, this.props.token);\n          })\n          .catch(err => {\n            console.error(err);\n            this.setState({\n              error: err\n            });\n          });\n      }\n    });\n  };\n\n  render() {\n    const {\n      getFieldDecorator,\n      getFieldsError,\n      getFieldError,\n      isFieldTouched\n    } = this.props.form;\n\n    const userNameError =\n      isFieldTouched(\"userName\") && getFieldError(\"userName\");\n    return (\n      <Form layout=\"inline\" onSubmit={this.handleSubmit}>\n        {this.state.error ? `${this.state.error}` : null}\n        <FormItem\n          validateStatus={userNameError ? \"error\" : \"\"}\n          help={userNameError || \"\"}\n        >\n          {getFieldDecorator(\"userName\", {\n            rules: [\n              {\n                required: true,\n                message:\n                  \"Please input the username of the person you want to chat with\"\n              }\n            ]\n          })(\n            <Select\n              mode=\"tags\"\n              style={{ width: \"100%\" }}\n              placeholder=\"Tags Mode\"\n              onChange={this.handleChange}\n            >\n              {[]}\n            </Select>\n          )}\n        </FormItem>\n        <FormItem>\n          <Button\n            type=\"primary\"\n            htmlType=\"submit\"\n            disabled={hasErrors(getFieldsError())}\n          >\n            Start a chat\n          </Button>\n        </FormItem>\n      </Form>\n    );\n  }\n}\n\nconst AddChatForm = Form.create()(HorizontalAddChatForm);\n\nconst mapStateToProps = state => {\n  return {\n    token: state.auth.token,\n    username: state.auth.username\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    closeAddChatPopup: () => dispatch(navActions.closeAddChatPopup()),\n    getUserChats: (username, token) =>\n      dispatch(messageActions.getUserChats(username, token))\n  };\n};\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(AddChatForm)\n);\n","import React from \"react\";\nimport { Modal } from \"antd\";\nimport Form from \"./Form\";\n\nclass AddChatModal extends React.Component {\n  render() {\n    return (\n      <Modal\n        centered\n        footer={null}\n        visible={this.props.isVisible}\n        onCancel={this.props.close}\n      >\n        <Form />\n      </Modal>\n    );\n  }\n}\n\nexport default AddChatModal;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport BaseRouter from \"./routes\";\nimport Sidepanel from \"./containers/Sidepanel\";\nimport Profile from \"./containers/Profile\";\nimport AddChatModal from \"./containers/Popup\";\nimport * as actions from \"./store/actions/auth\";\nimport * as navActions from \"./store/actions/nav\";\nimport * as messageActions from \"./store/actions/message\";\nimport WebSocketInstance from \"./websocket\";\nimport \"./assets/style.css\";\n\nclass App extends React.Component {\n  componentDidMount() {\n    this.props.onTryAutoSignup();\n  }\n\n  constructor(props) {\n    super(props);\n    WebSocketInstance.addCallbacks(\n      this.props.setMessages.bind(this),\n      this.props.addMessage.bind(this)\n    );\n  }\n\n  render() {\n    return (\n      <Router>\n        <div id=\"frame\">\n          <Sidepanel />\n          <div className=\"content\">\n            <AddChatModal\n              isVisible={this.props.showAddChatPopup}\n              close={() => this.props.closeAddChatPopup()}\n            />\n            <Profile />\n            <BaseRouter />\n          </div>\n        </div>\n      </Router>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    showAddChatPopup: state.nav.showAddChatPopup,\n    authenticated: state.auth.token\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onTryAutoSignup: () => dispatch(actions.authCheckState()),\n    closeAddChatPopup: () => dispatch(navActions.closeAddChatPopup()),\n    addMessage: message => dispatch(messageActions.addMessage(message)),\n    setMessages: messages => dispatch(messageActions.setMessages(messages))\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App);\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { createStore, compose, applyMiddleware, combineReducers } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport thunk from \"redux-thunk\";\nimport \"antd/dist/antd.css\";\nimport authReducer from \"./store/reducers/auth\";\nimport navReducer from \"./store/reducers/nav\";\nimport messageReducer from \"./store/reducers/message\";\nimport App from \"./App\";\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nfunction configureStore() {\n  const rootReducer = combineReducers({\n    auth: authReducer,\n    nav: navReducer,\n    message: messageReducer\n  });\n\n  const store = createStore(\n    rootReducer,\n    composeEnhancers(applyMiddleware(thunk))\n  );\n\n  //   if (module.hot) {\n  //     module.hot.accept(\"./store/reducers\", () => {\n  //       const nextRootReducer = require(\"./store/reducers/auth\");\n  //       store.replaceReducer(nextRootReducer);\n  //     });\n  //   }\n\n  return store;\n}\n\nconst store = configureStore();\n\nconst app = (\n  <Provider store={store}>\n    <App />\n  </Provider>\n);\n\nReactDOM.render(app, document.getElementById(\"app\"));\n"],"sourceRoot":""}